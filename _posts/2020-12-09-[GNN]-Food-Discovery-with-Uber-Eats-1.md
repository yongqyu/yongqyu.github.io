---
layout: post
category: develop
comments_id: 2
---
# [ : Using Graph Learning to Power Recommendations](https://eng.uber.com/uber-eats-graph-learning/)  
Uber Engineering Blog  
Ankit Jain, Isaac Liu, Ankur Sarda, and Piero Molino  
December 4, 2019

아래 글은 위 글의 비공식 약식 번역본 입니다.

-----------------------------------------------------
우버이츠 앱은 많은 나라 많은 도시의 32만 식당들에게 서비스를 제공합니다. 유저 경험이 더 단순하도록, 우리는 사용자가 좋아할만한 음식, 식당 그리고 요리를 보여줍니다. 이를 위해 우리는 미리 다양한 목적에 최적화된 ML 모델들을 우버이츠 앱에 개발해두었습니다.

흥미로운 연구 [^1] 하나가 추천을 위한 그래프 러닝 방법의 효과를 보여줬습니다. 이 아이디어를 우버이츠에 적용해, 우리는 개인들에게 보여줘야 할 음식이 보여지도록 하는 그래프 러닝 기술을 개발했습니다. 이 방법은 음식과 식당 추천의 연관성을 향상시켰습니다.

### Graph learning in a nutshell

우리가 어떻게 우버이츠의 추천을 만들었는지 더 정확히 이해하려면, 그래프 러닝의 기초적인 작동법을 아는게 도움이 됩니다. 많은 머신러닝 태스크들은 노드의 표현을 학습함으로 그래프 구조에서 작동합니다. 그래프로부터 학습한 표현은 그래프의 성향을 함축하고 있으며, 다음에 언급할 태스크들에서도 사용하기 쉽습니다. 예를 들어, 우버이츠의 개인 사용자를 표현하기 위해 우리는 단순히 주문 기록만을 보지 않고, 다른 연관된 음식 정보나 유사 사용자들의 성향을 사용합니다.

특히, 이런 표현을 얻기 위해, 우리는 그래프의 각 노드들을 벡터로 표현합니다. 이 경우, 노드들은 사용자, 식당, 음식들이 될 수 있습니다. 그리고 각 노드 벡터들간의 유사도는 두 노드들의 결합 강도와 유사하다고 봅니다. 우리의 목표는 이 노드의 벡터들로부터 유사도 지도를 구하는 것 입니다.

우버이츠의 경우, 우리는 인코딩 함수로 graph neural network(GNN) 기반의 접근법을 채택했습니다. 이 유형의 방법은, 제안된지 오래되지 않았지만 연구 분야에서는 폭넓게 적용되고 있고 추천 시스템에서도 효과를 보였습니다.

GNN의 기본 아이디어는 아래 그림과 같이, 반복적으로 주변 노드들의 정보를 통합함으로써 한 노드를 표현하는데 있습니다. 주변의 정의는 제한된 깊이로 제한됩니다.

![fig1](https://1fykyq3mdn5r21tpna3wkdyi-wpengine.netdna-ssl.com/wp-content/uploads/2019/12/image9-1.png)
*Figure 1: 왼쪽 그래프를 입력으로, 오른쪽 GNN이 노드 A의 표현을 구하고 있습니다.*

우리는 A로부터 BFS 깊이 제한을 두번으로 설정했습니다. 그런 다음, A로 두 홉 떨어진 노드들의 특징을 구합니다. 이 특징들은 통합 함수를 통해 합치는데, 여기서는, 평균을 취한 후 학습 가능한 매트릭스 W에 곱해 (fig 1의 PROJ W) A로 부터 한 홉 떨어져있는 노드들의 표현을 얻습니다.

이 이웃 표현들은 노드 자신의 정보를 학습 가능한 매트릭스 B에 곱한 후 (fig 1의 PROJ B) 통합되고, 이 통합식은 표현 h 꼴을 띈다. 이 표현은 A의 표현을 구할 때 까지 반복적으로 통합되고 곱해지며, W와 B는 매층마다 독립적으로 존재한다. 이렇게 표현을 구하는 가장 큰 장점은 그림 2에서와 같이, 이 표현이 노드 A의 성향과 구조적 정보를 동시에 표현한다는 것이다.

![fig2](https://1fykyq3mdn5r21tpna3wkdyi-wpengine.netdna-ssl.com/wp-content/uploads/2019/12/image5-1.png)
*Figure 2: 이 식들은 Figure 1에 있는 연산들이다.*

우리는 이제 이 노드 표현들을 두 노드간의 엣지가 존재하는지 그렇지 않은지를 예측하는데 사용한다.

GNNs은 그래프의 크기와 상관 없이 고정된 파라미터만을 필요로 해, 학습이 확장 가능하게 하며, 특히, 이웃 노드의 수를 제한하면 더욱 그렇다. 게다가, 새로 추가된 노드에도 적용이 가능한데, 이 특징이 매일 새로 추가되는 우버이츠의 추천에 도움을 주고 있다.

---
{: data-content="footnotes"}

[^1]: Rex Ying, Ruining He, Kaifeng Chen, Pong Eksombatchai, William L. Hamilton and Jure Leskovec: Graph Convolutional Neural Networks for Web-Scale Recommender Systems, KDD 2018
